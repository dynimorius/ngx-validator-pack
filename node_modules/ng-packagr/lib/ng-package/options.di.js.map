{"version":3,"file":"options.di.js","sourceRoot":"","sources":["../../../src/lib/ng-package/options.di.ts"],"names":[],"mappings":";;;;;;AAAA,oEAAgD;AAChD,+CAAuE;AACvE,2BAA4B;AAC5B,+BAA+B;AAElB,QAAA,aAAa,GAAG,IAAI,6BAAc,CAAmB,eAAe,CAAC,CAAC;AAQ5E,MAAM,cAAc,GAAG,CAAC,UAA4B,EAAE,EAAiB,EAAE,CAAC,CAAC;IAChF,OAAO,EAAE,qBAAa;IACtB,QAAQ,EAAE,gBAAgB,CAAC,OAAO,CAAC;CACpC,CAAC,CAAC;AAHU,QAAA,cAAc,kBAGxB;AAEU,QAAA,wBAAwB,GAAa,IAAA,sBAAc,GAAE,CAAC;AAEnE,SAAS,gBAAgB,CAAC,UAA4B,EAAE;IACtD,MAAM,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IAChC,MAAM,IAAI,GAAG,CAAA,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,WAAW,EAAE,MAAK,MAAM,IAAI,KAAK,KAAK,GAAG,CAAC;IAC9D,MAAM,EAAE,YAAY,GAAG,CAAC,IAAI,EAAE,cAAc,GAAG,aAAa,EAAE,EAAE,GAAG,OAAO,CAAC;IAE3E,OAAO;QACL,GAAG,OAAO;QACV,YAAY;QACZ,cAAc;KACf,CAAC;AACJ,CAAC;AAED,SAAS,aAAa;IACpB,MAAM,IAAI,GAAG,YAAY,CAAC;IAE1B,OAAO,IAAA,wBAAkB,EAAC,EAAE,IAAI,EAAE,CAAC,IAAI,IAAA,cAAO,EAAC,IAAA,WAAM,GAAE,EAAE,IAAI,CAAC,CAAC;AACjE,CAAC","sourcesContent":["import findCacheDirectory from 'find-cache-dir';\nimport { InjectionToken, Provider, ValueProvider } from 'injection-js';\nimport { tmpdir } from 'os';\nimport { resolve } from 'path';\n\nexport const OPTIONS_TOKEN = new InjectionToken<NgPackagrOptions>(`ng.v5.options`);\nexport interface NgPackagrOptions {\n  /** Whether or not ng-packagr will watch for file changes and perform an incremental build. */\n  watch?: boolean;\n  cacheEnabled?: boolean;\n  cacheDirectory?: string;\n}\n\nexport const provideOptions = (options: NgPackagrOptions = {}): ValueProvider => ({\n  provide: OPTIONS_TOKEN,\n  useValue: normalizeOptions(options),\n});\n\nexport const DEFAULT_OPTIONS_PROVIDER: Provider = provideOptions();\n\nfunction normalizeOptions(options: NgPackagrOptions = {}) {\n  const ciEnv = process.env['CI'];\n  const isCI = ciEnv?.toLowerCase() === 'true' || ciEnv === '1';\n  const { cacheEnabled = !isCI, cacheDirectory = findCachePath() } = options;\n\n  return {\n    ...options,\n    cacheEnabled,\n    cacheDirectory,\n  };\n}\n\nfunction findCachePath(): string {\n  const name = 'ng-packagr';\n\n  return findCacheDirectory({ name }) || resolve(tmpdir(), name);\n}\n"]}